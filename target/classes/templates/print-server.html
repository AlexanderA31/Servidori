<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Servidor de Impresi√≥n Centralizado</title>
    <link rel="stylesheet" th:href="@{/css/print-server.css}"/>
    <!--<style>
        :root {
            --primary: #1a1a1a;
            --secondary: #2d2d2d;
            --accent: #4a90e2;
            --text: #333333;
            --text-light: #666666;
            --border: #e0e0e0;
            --bg-light: #f5f5f5;
            --bg-white: #ffffff;
            --success: #27ae60;
            --shadow: rgba(0, 0, 0, 0.08);
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', sans-serif;
            background: var(--bg-light);
            min-height: 100vh;
            padding: 0;
            margin: 0;
            color: var(--text);
            line-height: 1.6;
        }
        
        .navbar {
            background: var(--primary);
            color: white;
            padding: 1rem 2rem;
            box-shadow: 0 2px 4px var(--shadow);
        }
        
        .navbar-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .navbar-title {
            font-size: 1.25rem;
            font-weight: 600;
            letter-spacing: -0.5px;
        }
        
        .navbar-subtitle {
            font-size: 0.875rem;
            color: #999;
            margin-top: 0.25rem;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .header {
            background: var(--bg-white);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 1px 3px var(--shadow);
        }
        
        .header-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 0.5rem;
            letter-spacing: -0.5px;
        }
        
        .header-subtitle {
            color: var(--text-light);
            font-size: 0.95rem;
        }
        
        .server-info {
            background: var(--bg-light);
            padding: 1.5rem;
            border-radius: 6px;
            margin-top: 1.5rem;
            border: 1px solid var(--border);
        }
        
        .server-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }
        
        .server-info-item {
            text-align: center;
        }
        
        .server-info-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            color: var(--text-light);
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }
        
        .server-info-value {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Courier New', monospace;
        }
        
        .server-info-value.accent {
            color: var(--accent);
        }
        
        .section-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 1.5rem;
            letter-spacing: -0.3px;
        }
        
        .printers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .printer-card {
            background: var(--bg-white);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            transition: all 0.2s ease;
        }
        
        .printer-card:hover {
            border-color: var(--accent);
            box-shadow: 0 4px 12px var(--shadow);
        }
        
        .printer-name {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 0.75rem;
            letter-spacing: -0.3px;
        }
        
        .printer-details {
            color: var(--text-light);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }
        
        .printer-details div {
            margin: 0.5rem 0;
            display: flex;
            align-items: center;
        }
        
        .printer-details strong {
            min-width: 80px;
            color: var(--text);
        }
        
        .code-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            color: var(--text-light);
            letter-spacing: 0.5px;
            margin: 1rem 0 0.5rem 0;
        }
        
        .uri-box {
            background: var(--secondary);
            color: #e0e0e0;
            padding: 1rem;
            border-radius: 6px;
            font-family: 'SF Mono', 'Monaco', monospace;
            font-size: 0.813rem;
            word-break: break-all;
            border: 1px solid #3a3a3a;
            position: relative;
        }
        
        .command-box {
            background: var(--secondary);
            color: #b0b0b0;
            padding: 1rem;
            border-radius: 6px;
            font-family: 'SF Mono', 'Monaco', monospace;
            font-size: 0.813rem;
            margin: 0.5rem 0 1rem 0;
            overflow-x: auto;
            border: 1px solid #3a3a3a;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.625rem 1rem;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 500;
            font-size: 0.875rem;
            transition: all 0.15s ease;
            border: 1px solid transparent;
            cursor: pointer;
            margin: 0.25rem 0.5rem 0.25rem 0;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .btn-primary:hover {
            background: var(--secondary);
            border-color: var(--secondary);
        }
        
        .btn-outline {
            background: transparent;
            color: var(--primary);
            border-color: var(--border);
        }
        
        .btn-outline:hover {
            background: var(--bg-light);
            border-color: var(--primary);
        }
        
        .instructions {
            background: var(--bg-white);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 1.5rem;
        }
        
        .instructions h2 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 1.5rem;
            letter-spacing: -0.3px;
        }
        
        .instructions h3 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text);
            margin: 1.5rem 0 1rem 0;
        }
        
        .instructions h4 {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text);
            margin: 1.25rem 0 0.75rem 0;
        }
        
        .instructions ol {
            margin-left: 1.5rem;
        }
        
        .instructions li {
            margin: 0.75rem 0;
            line-height: 1.7;
        }
        
        .tab-container {
            margin: 20px 0;
        }
        
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0;
            border-bottom: 1px solid var(--border);
        }
        
        .tab {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.875rem;
            color: var(--text-light);
            transition: all 0.15s ease;
        }
        
        .tab:hover {
            color: var(--text);
        }
        
        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        .tab-content {
            display: none;
            padding: 1.5rem;
            background: var(--bg-light);
            border-radius: 0 0 6px 6px;
            border: 1px solid var(--border);
            border-top: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .alert {
            padding: 1rem;
            border-radius: 6px;
            margin: 1rem 0;
            font-size: 0.875rem;
            border: 1px solid;
        }
        
        .alert-info {
            background: #e8f4f8;
            border-color: var(--accent);
            color: #2563eb;
        }
        
        .alert-warning {
            background: #fff8e1;
            border-color: #ffa726;
            color: #e65100;
        }
        
        .no-printers {
            text-align: center;
            padding: 4rem 2rem;
            background: var(--bg-white);
            border: 2px dashed var(--border);
            border-radius: 8px;
            color: var(--text-light);
        }
        
        .no-printers h2 {
            color: var(--text);
            margin-bottom: 0.5rem;
        }
        
        .copy-feedback {
            display: none;
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: var(--primary);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            animation: slideIn 0.2s ease;
            font-size: 0.875rem;
            z-index: 1000;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>-->
</head>
<body>
    <!-- Navbar -->
    <div class="navbar">
        <div class="navbar-content">
            <div>
                <div class="navbar-title">Servidor de Impresi√≥n Centralizado</div>
                <div class="navbar-subtitle">Red IP √önica para Todas las Impresoras</div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <!-- Server Info -->
        <div class="header">
            <div class="header-title">Informaci√≥n del Servidor</div>
            <div class="header-subtitle">Todos los clientes Windows, Linux y macOS pueden conectarse a esta √∫nica direcci√≥n</div>
            
            <div class="server-info">
                <div class="server-info-grid">
                    <div class="server-info-item">
                        <div class="server-info-label">Direcci√≥n IP Fija</div>
                        <div class="server-info-value accent" th:text="${serverIp}">192.168.1.100</div>
                    </div>
                    <div class="server-info-item">
                        <div class="server-info-label">Puerto IPP</div>
                        <div class="server-info-value">8631</div>
                    </div>
                    <div class="server-info-item">
                        <div class="server-info-label">Impresoras Disponibles</div>
                        <div class="server-info-value" th:text="${totalPrinters}">0</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Configurar Impresora IPP en Cliente -->
        <div th:if="${totalPrinters > 0}" class="instructions" style="margin-bottom: 2rem;">
            <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M6 9h8M6 13h8M6 17h8M18 9v12M18 9l-3-3M18 9l3-3"/>
                    <path d="M3 3h12v6H3z"/>
                </svg>
                <h2 style="margin: 0; font-size: 1.25rem; font-weight: 600;">Configurar Impresora IPP en Cliente</h2>
            </div>
            
            <p style="color: var(--text-light); margin-bottom: 1.5rem;">
                Configura una computadora cliente para usar las impresoras compartidas
            </p>
            
            <div style="margin-bottom: 1.5rem;">
                <label for="printerSelect" style="display: block; font-weight: 600; margin-bottom: 0.75rem; color: var(--text);">
                    Selecciona la impresora:
                </label>
                <select id="printerSelect" class="printer-select" style="width: 100%; padding: 0.875rem; font-size: 1rem; border: 2px solid var(--border); border-radius: 6px; background: white; cursor: pointer; transition: all 0.2s;">
                    <option value="">-- Selecciona una impresora --</option>
                    <option th:each="printer : ${printerInfos}" 
                            th:value="${printer.name}" 
                            th:attr="data-port=${printer.port}, data-ippuri=${printer.ippUri}"
                            th:text="${printer.name} + ' (Puerto: ' + ${printer.port} + ')'">
                      
                    </option>
                </select>
            </div>
            
            <div id="printerInfo" style="display: none; margin-top: 1.5rem;">
                <div style="background: var(--bg-light); padding: 1.25rem; border-radius: 6px; border-left: 4px solid var(--accent); margin-bottom: 1rem;">
                    <div class="code-label" style="margin: 0 0 0.5rem 0;">URL IPP:</div>
                    <div id="printerUrl" class="uri-box" style="margin: 0;"></div>
                </div>
                
                <div class="tabs" style="display: flex; gap: 0; border: 1px solid var(--border); border-radius: 6px; overflow: hidden; margin-bottom: 1rem;">
                    <button class="os-tab active" data-os="windows" style="flex: 1; padding: 0.75rem; background: var(--accent); color: white; border: none; cursor: pointer; font-weight: 500; transition: all 0.2s;">
                        Windows
                    </button>
                    <button class="os-tab" data-os="linux" style="flex: 1; padding: 0.75rem; background: white; color: var(--text); border: none; border-left: 1px solid var(--border); cursor: pointer; font-weight: 500; transition: all 0.2s;">
                        Linux
                    </button>
                    <button class="os-tab" data-os="macos" style="flex: 1; padding: 0.75rem; background: white; color: var(--text); border: none; border-left: 1px solid var(--border); cursor: pointer; font-weight: 500; transition: all 0.2s;">
                        macOS
                    </button>
                </div>
                
                <div id="windowsDownload" class="os-content">
                    <button id="downloadWindowsBtn" class="btn btn-primary" style="font-size: 1rem; padding: 0.875rem 1.5rem; width: 100%; justify-content: center;">
                        üíæ Descargar Script Configurado (PowerShell)
                    </button>
                    <p style="margin-top: 0.75rem; font-size: 0.875rem; color: var(--text-light); text-align: center;">
                        El script ya viene configurado con esta impresora. Solo ejec√∫talo como Administrador.
                    </p>
                </div>
                
                <div id="linuxDownload" class="os-content" style="display: none;">
                    <button id="downloadLinuxBtn" class="btn btn-primary" style="font-size: 1rem; padding: 0.875rem 1.5rem; width: 100%; justify-content: center;">
                        üíæ Descargar Script Configurado (Bash)
                    </button>
                    <p style="margin-top: 0.75rem; font-size: 0.875rem; color: var(--text-light); text-align: center;">
                        El script ya viene configurado con esta impresora. Ejec√∫talo con: ./configurar-impresora.sh
                    </p>
                </div>
                
                <div id="macosDownload" class="os-content" style="display: none;">
                    <div class="alert alert-info">
                        <strong>Instalaci√≥n Manual en macOS:</strong><br>
                        <ol style="margin: 0.5rem 0 0 1.5rem; padding: 0;">
                            <li>Abre <strong>Preferencias del Sistema</strong> ‚Üí <strong>Impresoras y Esc√°neres</strong></li>
                            <li>Haz clic en el bot√≥n <strong>"+"</strong></li>
                            <li>Selecciona la pesta√±a <strong>"IP"</strong></li>
                            <li>Protocolo: <strong>IPP</strong>, Direcci√≥n: <strong th:text="${serverIp}">10.1.1.79</strong>, Puerto: <strong>8631</strong></li>
                            <li>Cola: <code id="macosQueue">/printers/NOMBRE</code></li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>

        <!-- Impresoras disponibles -->
        <div th:if="${totalPrinters > 0}">
            <h2 class="section-title">Impresoras Disponibles</h2>
            <div class="printers-grid">
                <div class="printer-card" th:each="printer : ${printerInfos}">
                    <div class="printer-name" th:text="${printer.name}">HP LaserJet</div>
                    
                    <div class="printer-details">
                        <div><strong>Modelo:</strong> <span th:text="${printer.model}">HP LaserJet P1102</span></div>
                        <div><strong>Ubicaci√≥n:</strong> <span th:text="${printer.location}">Oficina Principal</span></div>
                    </div>
                    
                    <div style="margin-top: 1.5rem;">
                        <div class="code-label">URI de Conexi√≥n IPP</div>
                        <div class="uri-box" th:text="${printer.ippUri}">ipp://192.168.1.100:631/printers/HP_LaserJet</div>
                        <button class="btn btn-outline" th:onclick="'copyToClipboard(\'' + ${printer.ippUri} + '\')'">
                            Copiar URI
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div th:if="${totalPrinters == 0}" class="no-printers">
            <h2>No hay impresoras registradas</h2>
            <p>Agrega impresoras desde el panel de administraci√≥n para comenzar</p>
            <a href="/admin" class="btn btn-primary" style="margin-top: 1.5rem;">Ir al Panel de Administraci√≥n</a>
        </div>

        <!-- Instrucciones -->
        <div class="instructions">
            <h2>Gu√≠a de Instalaci√≥n para Clientes</h2>
            
            <div class="alert alert-info">
                <strong>Red IP √önica:</strong> Este servidor centraliza todas las impresoras en la direcci√≥n <strong><span th:text="${serverIp}">192.168.1.100</span></strong>. 
                Los clientes solo necesitan conectarse a esta IP sin importar en qu√© VLAN est√© f√≠sicamente cada impresora.
            </div>
            
            <div class="tab-container">
                <div class="tabs">
                    <div class="tab active" onclick="showTab('windows')">Windows</div>
                    <div class="tab" onclick="showTab('linux')">Linux</div>
                    <div class="tab" onclick="showTab('macos')">macOS</div>
                    <div class="tab" onclick="showTab('manual')">Manual</div>
                </div>
                
                <!-- Windows Tab -->
                <div class="tab-content active" id="windows-tab">
                    <h3>Instalaci√≥n Autom√°tica (PowerShell)</h3>
                    
                    <h4>Paso 1: Descargar el script</h4>
                    <a href="/print-server/download/windows-script" class="btn btn-primary">üì• Descargar configurar-impresora.ps1</a>
                    <p style="margin-top: 0.5rem; font-size: 0.875rem; color: var(--text-light);">Guarda el archivo en una carpeta de f√°cil acceso, por ejemplo: <code>C:\Scripts</code></p>
                    
                    <h4>Paso 2: Abrir PowerShell como Administrador</h4>
                    <ol>
                        <li>Presiona <strong>Windows + X</strong></li>
                        <li>Selecciona <strong>"Windows PowerShell (Admin)"</strong> o <strong>"Terminal (Admin)"</strong></li>
                    </ol>
                    
                    <h4>Paso 3: Permitir ejecuci√≥n de scripts (solo primera vez)</h4>
                    <div class="command-box">Set-ExecutionPolicy RemoteSigned -Scope CurrentUser</div>
                    <p style="font-size: 0.875rem; color: var(--text-light); margin-top: 0.5rem;">Escribe <strong>S</strong> o <strong>Y</strong> cuando te lo pida y presiona Enter</p>
                    
                    <h4>Paso 4: Navegar a la carpeta del script</h4>
                    <div class="command-box">cd C:\Scripts</div>
                    <p style="font-size: 0.875rem; color: var(--text-light); margin-top: 0.5rem;">Cambia la ruta a donde guardaste el archivo</p>
                    
                    <h4>Paso 5: Ejecutar el script</h4>
                    <p style="margin-bottom: 0.5rem;">Sintaxis del comando (solo necesitas el nombre de la impresora):</p>
                    <div class="command-box">.\configurar-impresora.ps1 -PrinterName "NOMBRE_IMPRESORA"</div>
                    
                    <p style="margin-top: 1rem; font-size: 0.875rem; color: var(--text-light);">Por defecto usa la IP <strong th:text="${serverIp}">10.1.1.43</strong> y puerto <strong>8631</strong>. Si necesitas cambiarlos:</p>
                    <div class="command-box">.\configurar-impresora.ps1 -ServerIP "<span th:text="${serverIp}">10.1.1.43</span>" -ServerPort 8631 -PrinterName "NOMBRE_IMPRESORA"</div>
                    
                    <div class="alert alert-info" style="margin-top: 1rem;">
                        <strong>üí° Ejemplos:</strong><br>
                        <code>.\configurar-impresora.ps1 -PrinterName "EPSON26"</code><br>
                        <code>.\configurar-impresora.ps1 -PrinterName "HP_LaserJet" -DisplayName "HP Oficina"</code>
                    </div>
                    
                    <div class="alert alert-warning" style="margin-top: 1rem;">
                        <strong>‚ö†Ô∏è Importante:</strong>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                            <li>El nombre de la impresora debe coincidir <strong>exactamente</strong> con uno de los listados arriba</li>
                            <li>Los nombres son sensibles a may√∫sculas/min√∫sculas</li>
                            <li>No incluyas espacios, usa guiones bajos (_) en su lugar</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Linux Tab -->
                <div class="tab-content" id="linux-tab">
                    <h3>Instalaci√≥n Autom√°tica (Bash)</h3>
                    
                    <h4>Paso 1: Descargar el script</h4>
                    <a href="/print-server/download/linux-script" class="btn btn-primary">üì• Descargar configurar-impresora.sh</a>
                    <p style="margin-top: 0.5rem; font-size: 0.875rem; color: var(--text-light);">O desc√°rgalo desde la terminal:</p>
                    <div class="command-box">wget http://<span th:text="${serverIp}">192.168.1.100</span>:8080/print-server/download/linux-script -O configurar-impresora.sh</div>
                    
                    <h4>Paso 2: Dar permisos de ejecuci√≥n</h4>
                    <div class="command-box">chmod +x configurar-impresora.sh</div>
                    
                    <h4>Paso 3: Verificar que CUPS est√© instalado</h4>
                    <p style="margin-bottom: 0.5rem;">El script lo instalar√° autom√°ticamente si no lo tienes, pero puedes verificar con:</p>
                    <div class="command-box">which lpadmin</div>
                    <p style="font-size: 0.875rem; color: var(--text-light); margin-top: 0.5rem;">Si no est√° instalado, puedes instalarlo manualmente con:</p>
                    <div class="command-box"># Ubuntu/Debian
sudo apt-get update
sudo apt-get install cups

# Fedora/RHEL
sudo yum install cups</div>
                    
                    <h4>Paso 4: Ejecutar el script</h4>
                    <p style="margin-bottom: 0.5rem;">Sintaxis b√°sica (solo necesitas el nombre de la impresora):</p>
                    <div class="command-box">./configurar-impresora.sh &lt;NOMBRE-IMPRESORA&gt; [ALIAS] [IP-SERVIDOR] [PUERTO]</div>
                    
                    <p style="margin-top: 1rem; margin-bottom: 0.5rem;">Ejemplo simple (usa IP <strong th:text="${serverIp}">10.1.1.43</strong> por defecto):</p>
                    <div class="command-box">./configurar-impresora.sh EPSON26</div>
                    
                    <p style="margin-top: 1rem; margin-bottom: 0.5rem;">Ejemplo con alias personalizado:</p>
                    <div class="command-box">./configurar-impresora.sh EPSON26 "Epson Oficina"</div>
                    
                    <p style="margin-top: 1rem; margin-bottom: 0.5rem;">Si necesitas especificar otra IP o puerto:</p>
                    <div class="command-box">./configurar-impresora.sh HP_LaserJet "HP" <span th:text="${serverIp}">10.1.1.43</span> 8631</div>
                    
                    <div class="alert alert-info" style="margin-top: 1rem;">
                        <strong>üí° Consejos:</strong>
                        <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                            <li>El script te pedir√° tu contrase√±a de sudo para instalar la impresora</li>
                            <li>El alias es opcional, si no lo especificas usar√° el nombre de la impresora</li>
                            <li>El alias puede contener espacios si lo pones entre comillas</li>
                        </ul>
                    </div>
                    
                    <h4>Paso 5: Verificar la instalaci√≥n</h4>
                    <p style="margin-bottom: 0.5rem;">Una vez instalada, verifica que la impresora est√© disponible:</p>
                    <div class="command-box">lpstat -p</div>
                    
                    <p style="margin-top: 1rem; margin-bottom: 0.5rem;">Para imprimir una p√°gina de prueba:</p>
                    <div class="command-box">lp -d NOMBRE_IMPRESORA /usr/share/cups/data/testprint</div>
                </div>
                
                <!-- Manual Tab -->
                <!-- macOS Tab -->
                <div class="tab-content" id="macos-tab">
                    <h3>Configuraci√≥n en macOS</h3>
                    <ol>
                        <li>Abre <strong>Preferencias del Sistema</strong> ‚Üí <strong>Impresoras y Esc√°neres</strong></li>
                        <li>Haz clic en el bot√≥n <strong>"+"</strong> para agregar una impresora</li>
                        <li>En la ventana que aparece, selecciona la pesta√±a <strong>"IP"</strong></li>
                        <li>Configura los siguientes valores:</li>
                    </ol>
                    <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                        <li><strong>Protocolo:</strong> Internet Printing Protocol - IPP</li>
                        <li><strong>Direcci√≥n:</strong> <code th:text="${serverIp}">192.168.1.100</code></li>
                        <li><strong>Puerto:</strong> <code>8631</code></li>
                        <li><strong>Cola:</strong> <code>/printers/NOMBRE_IMPRESORA</code></li>
                    </ul>
                    <ol start="5">
                        <li>macOS detectar√° autom√°ticamente el driver apropiado</li>
                        <li>Haz clic en <strong>"Agregar"</strong></li>
                    </ol>
                </div>
                
                <!-- Manual Tab -->
                <div class="tab-content" id="manual-tab">
                    <h3>Instalaci√≥n Manual</h3>
                    
                    <h4>Windows 10/11:</h4>
                    <ol>
                        <li>Ve a <strong>Configuraci√≥n ‚Üí Dispositivos ‚Üí Impresoras y esc√°neres</strong></li>
                        <li>Click en <strong>"Agregar una impresora o esc√°ner"</strong></li>
                        <li>Click en <strong>"La impresora deseada no est√° en la lista"</strong></li>
                        <li>Selecciona <strong>"Seleccionar una impresora compartida por nombre"</strong></li>
                        <li>Ingresa el URI IPP (ej: <code>http://<span th:text="${serverIp}">192.168.1.100</span>:8631/printers/HP_LaserJet</code>)</li>
                        <li>Sigue las instrucciones del asistente</li>
                    </ol>
                    
                    <h4>Linux (CUPS):</h4>
                    <ol>
                        <li>Abre un terminal</li>
                        <li>Ejecuta (reemplaza los valores):</li>
                    </ol>
                    
                    <div class="command-box">lpadmin -p NOMBRE_IMPRESORA -E -v ipp://<span th:text="${serverIp}">192.168.1.100</span>:8631/printers/NOMBRE_IMPRESORA -m everywhere</div>
                    
                    <h4>Configuraci√≥n V√≠a Web (CUPS):</h4>
                    <p>Si tu sistema tiene CUPS instalado, tambi√©n puedes agregar impresoras desde la interfaz web:</p>
                    <ol>
                        <li>Abre tu navegador y ve a: <code>http://localhost:631</code></li>
                        <li>Ve a <strong>Administration</strong> ‚Üí <strong>Add Printer</strong></li>
                        <li>Selecciona <strong>Internet Printing Protocol (ipp)</strong></li>
                        <li>Ingresa la URI completa: <code>ipp://<span th:text="${serverIp}">192.168.1.100</span>:8631/printers/NOMBRE_IMPRESORA</code></li>
                        <li>Completa el formulario y guarda</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- API Information -->
        <div class="instructions">
            <h2>API REST para Desarrolladores</h2>
            <p>Obt√©n la lista de impresoras disponibles program√°ticamente mediante la API REST:</p>
            
            <div class="command-box">
                curl http://<span th:text="${serverIp}">192.168.1.100</span>:8080/print-server/api/printers
            </div>
            
            <p style="margin-top: 15px;">Respuesta JSON:</p>
            <div class="command-box">
{
  "serverIp": "<span th:text="${serverIp}">192.168.1.100</span>",
  "port": 8631,
  "printers": [
    {
      "name": "HP_LaserJet",
      "model": "HP LaserJet P1102",
      "location": "Oficina Principal",
      "ippUri": "ipp://<span th:text="${serverIp}">192.168.1.100</span>:631/printers/HP_LaserJet"
    }
  ],
  "total": 1
}
            </div>
        </div>
    </div>

    <!-- Copy Feedback -->
    <div class="copy-feedback" id="copyFeedback">
        ‚úì URI copiado al portapapeles
    </div>

    <script th:inline="javascript">
        // Variables del servidor
        const serverIp = /*[[${serverIp}]]*/ '10.1.1.79';
        const serverPort = 8631;
        
        // Datos de impresoras
        const printers = /*[[${printerInfos}]]*/ [];
        
        // Selector de impresora
        document.getElementById('printerSelect')?.addEventListener('change', function(e) {
            const printerName = e.target.value;
            const printerInfo = document.getElementById('printerInfo');
            
            if (!printerName) {
                printerInfo.style.display = 'none';
                return;
            }
            
            // Obtener puerto de la opci√≥n seleccionada
            const selectedOption = e.target.options[e.target.selectedIndex];
            const port = selectedOption.dataset.port || serverPort;
            const ippUri = selectedOption.dataset.ippuri;
            
            console.log('Impresora seleccionada:', { printerName, port, ippUri });
            
            // Mostrar informaci√≥n de la impresora
            printerInfo.style.display = 'block';
            
            // Actualizar URL IPP
            document.getElementById('printerUrl').textContent = ippUri;
            document.getElementById('macosQueue').textContent = `/printers/${printerName}`;
            
            // Configurar botones de descarga (los scripts ya usar√°n el puerto correcto del URI)
            document.getElementById('downloadWindowsBtn').onclick = function() {
                window.location.href = `/print-server/download/windows-script/${printerName}`;
            };
            
            document.getElementById('downloadLinuxBtn').onclick = function() {
                window.location.href = `/print-server/download/linux-script/${printerName}`;
            };
        });
        
        // Tabs de sistema operativo
        document.querySelectorAll('.os-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const os = this.dataset.os;
                
                // Actualizar tabs activos
                document.querySelectorAll('.os-tab').forEach(t => {
                    t.classList.remove('active');
                    t.style.background = 'white';
                    t.style.color = 'var(--text)';
                });
                this.classList.add('active');
                this.style.background = 'var(--accent)';
                this.style.color = 'white';
                
                // Mostrar contenido correspondiente
                document.querySelectorAll('.os-content').forEach(content => {
                    content.style.display = 'none';
                });
                document.getElementById(`${os}Download`).style.display = 'block';
            });
        });
        
        // Hover effect for select
        const printerSelect = document.getElementById('printerSelect');
        if (printerSelect) {
            printerSelect.addEventListener('focus', function() {
                this.style.borderColor = 'var(--accent)';
            });
            printerSelect.addEventListener('blur', function() {
                this.style.borderColor = 'var(--border)';
            });
        }
        
        function showTab(tabName) {
            // Ocultar todos los tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Mostrar tab seleccionado
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }
        
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                const feedback = document.getElementById('copyFeedback');
                feedback.style.display = 'block';
                
                setTimeout(() => {
                    feedback.style.display = 'none';
                }, 2000);
            });
        }
    </script>
</body>
</html>
